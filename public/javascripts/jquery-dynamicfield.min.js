/*
 * jQuery dynamicField plugin
 * Copyright 2009, Matt Quackenbush (http://www.quackfuzed.com/)
 * 
 * Find usage demos at http://www.quackfuzed.com/demos/jQuery/dynamicField/index.cfm)
 * 
 * Dual licensed under the MIT (http://www.opensource.org/licenses/mit-license.php)
 * and GPL (http://www.opensource.org/licenses/gpl-license.php) licenses.
 * 
 * Version: 1.0
 * Date:	 8/13/2009
 */
(function(a){a.fn.dynamicField=function(c){if(a(this).attr("id")==undefined){alert("The dynamicField plugin could not be initialized.\n\nPlease check the selector.");return a}var e=a(this);var d=a.extend({maxFields:5,removeImgSrc:"/commonassets/images/icons/cross.png",spacerImgSrc:"/commonassets/images/spacer.gif",addTriggerClass:"add-field-trigger",removeImgClass:"remove-field-trigger",hideClass:"hide",cloneContainerId:e.attr("id").replace(/^(.+)([_-][0-9]+)$/,"$1"),rowContainerClass:e.attr("class"),
labelText:e.children("label").html(),baseName:e.children("input").attr("name").replace(/^(.+[_-])([0-9]+)$/,"$1"),addContainerId:"add-"+e.children("input").attr("name").replace(/^(.+)([_-][0-9]+)$/,"$1").replace(/_/g,"-")+"-container"},c);var g=function(){return a("div."+d.rowContainerClass)};var b=function(){var h=g();var f=h.length;h.each(function(j,k){a(k).children("img").attr({src:(f==1)?d.spacerImgSrc:d.removeImgSrc,"class":(f==1)?"":d.removeImgClass})});if(f>(d.maxFields-1)){
a("div#"+d.addContainerId).addClass(d.hideClass)}else{a("div#"+d.addContainerId).removeClass(d.hideClass)}};a("img."+d.removeImgClass).live("click",function(){a(this).parent("div."+d.rowContainerClass).remove();g().each(function(f,h){var k=new Number(f+1);var j=a(h).attr("id",d.cloneContainerId+"-"+k);j.children("label").attr("for",d.baseName+k).html((k>1)?"":d.labelText);j.children("input").attr({id:d.baseName+k,name:d.baseName+k})});b()});a("div#"+d.addContainerId+" span."+d.addTriggerClass).click(
function(){var f=g().length;var i=new Number(f+1);var h=e.clone().attr("id",d.cloneContainerId+"-"+i).addClass(d.rowContainerClass);h.children("label").attr("for",d.baseName+i).html("");h.children("input").attr({id:d.baseName+i,name:d.baseName+i,value:""});h.children("img").attr("src",d.removeImgSrc);if(f>0){a("div#"+d.cloneContainerId+"-"+f).after(h)}else{a("div#"+d.addContainerId).before(h)}b()})}})(jQuery);
